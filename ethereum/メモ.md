# メモ書いてくよ

- [ERC20とERC721の違い](#erc20&erc721)

## テストプログラムについて
### テストの構造:
```javascript
describe("カテゴリ名", function() {
  it("テストケース名", async function() {
    // テストの内容
  });
});
```

- `describe`: テストをグループ化
- `it`: 個別のテストケース
- 入れ子にすることで階層的な構造を作れる

## フィクスチャ:
```js
// フィクスチャの定義
  async function deployTokenFixture() {
    // コントラクトをデプロイするアカウントとテスト用アカウントを取得
    [owner, addr1, addr2] = await ethers.getSigners();

    // コントラクトのデプロイ
    const MyERC20 = await ethers.getContractFactory("MyERC20");
    // 1000トークンを初期供給量として設定
    const initialSupply = ethers.parseUnits("1000", 18);
    const myToken = await MyERC20.deploy(initialSupply);
    await myToken.waitForDeployment();

    // 必要な値をまとめて返す
    return { myToken, owner, addr1, addr2, addrs, initialSupply };

// フィクスチャの呼び出し
const { hardhatToken, owner } = await loadFixture(deployTokenFixture);
```

利点：

**1. 状態のリセット:**
   - 各テストケースで新しい状態から始められる
   - テスト間の独立性が保たれる
  
**2. パフォーマンス向上:**
```js
// Hardhatはフィクスチャの状態をスナップショットとして保存
// 2回目以降のloadFixtureは高速
const { hardhatToken } = await loadFixture(deployTokenFixture);
```

**3. コードの再利用:**
```js
// 同じセットアップを複数のテストで使用可能
async function deployTokenFixture() {
  // 共通のセットアップコード
  return { /* 必要な値 */ };
}
```

**4. 可読性の向上:**
```js
// テストコードがよりクリーンに
it("Should work", async function () {
  const { hardhatToken, owner } = await loadFixture(deployTokenFixture);
  // テストロジック
});
```

## beforeEach:
```javascript
beforeEach(async function() {
// セットアップコード
});
```

- 各テストケースの前に実行される
- テスト環境を初期化する
- 共通の準備処理を書く

## ethers.js v5からv6への主な変更点
[Migrating from v5](https://docs.ethers.org/v6/migrating/)

- アドレス取得:
```javascript
// v5
contract.address

// v6
await contract.getAddress()
```

- コントラクトのデプロイ待機:
```javascript
// v5
await contract.deployed()

// v6
await contract.waitForDeployment()
```

- BigNumber関連:
```javascript
// v5
ethers.BigNumber.from("1000")

// v6
ethers.parseUnits("1000", 18)  // より明示的な方法
```

- プロバイダー作成:
```javascript
// v5
new ethers.providers.JsonRpcProvider()

// v6
ethers.getDefaultProvider()
// または
new ethers.JsonRpcProvider()
```

- コントラクトインスタンスの作成:
```javascript
// v5
new ethers.Contract(address, abi, signer)

// v6
ethers.getContractAt("ContractName", address)
```

- BigInt
```javascript
// ethers.js v5
amount1.add(amount2)      // 加算
amount1.sub(amount2)      // 減算
amount1.mul(amount2)      // 乗算
amount1.div(amount2)      // 除算

// ethers.js v6
amount1 + amount2         // 加算
amount1 - amount2         // 減算
amount1 * amount2         // 乗算
amount1 / amount2         // 除算
```



## <a id="erc20&erc721">ERC20とERC721の違い</a>


**1. 基本的な違い**
- ERC20（代替可能トークン）:
  - すべてのトークンが同じ価値
  - トークンは分割可能
  - 残高（balance）で管理

- ERC721（非代替トークン/NFT）:
  - 各トークンが一意の値を持つ
  - トークンは分割不可能
  - トークンID（tokenid）で管理
